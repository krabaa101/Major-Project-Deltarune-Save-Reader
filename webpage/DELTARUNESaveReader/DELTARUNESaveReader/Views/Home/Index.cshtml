@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deltarune Save Reader</title>
    <link rel="stylesheet" href="~/css/dRuneTrackerStylesheet.css">
    
</head>
<body>
    <div id="content">
        <h1 id="h1-title">Save Completion Tracker</h1>
        <h2 id="h2-subtitle">For Deltarune</h2>

        <p class="smalltext"><!-- write banner of hrefs here: steam guide, github --></p>

        <div class="tooltips">
            <!-- pasteable path for "noob users." -->
            <input id="save-location-input" value="%LOCALAPPDATA%\DELTARUNE" readonly="readonly">

            <span class="tooltips-text" id="save-location-input-tooltips">
                <br> <!-- Add JS on-hover for tooltips-text class -->
                "Click once to copy to clipboard" <!-- Add JS on-click handler here, onclick copy to clipboard and change message to "Copied to clipboard"-->
            </span>
        </div>

        <p class="smalltext">
            Choose
            <strong>filech1_#</strong>
            then drag and drop, or select directly in the box below.
        </p>

        <p class="smalltext">
            The number on the save file is which slot the file is saved in, 0 being slot 1, 1 being 2, and 2 being 3.
        </p>

        <p class="smalltext">Don't use filech1_3, 1_4, 1_6 or 1_9. 3, 4, and 5 are completion data and 9 is last autosave.</p>

        <p></p> <!--Empty paragraph for spacing.-->

        <div id="save-file-input">

            <!-- Add save file selection here eg. ("Drag and drop or select save file (use botton for select)" in a box.) -->
            <input id="saveInput" type="file" accept="file/*" value="">

            <!-- Informs user if file selected is a Deltarune Chapter 1 Save file (just checks filename) -->
            <p id="saveConfirmer">No file input yet.</p>

            <!-- Button to confirm file (I attempted to make a localStorage value that holds the filepath, but apparently input type: file values use a fakepath to keep user filepaths private.) -->
            <button id="confirmButton">Confirm!</button>
        </div>

        <div id="ResultDiv">
            <h2 id="h2-game-status">Game completion status:</h2> <!--  Add % variable through JS here (float) -->
        

            <p>Time Played</p> <!--JS displays data here-->
            <!--More Random Fun save facts here:-->

            <p id="testP">wow</p>
        </div>
    </div>
    <script>
        const docIdGet = document.getElementById;
        const input = document.getElementById('saveInput');
        const inButton = document.getElementById("confirmButton");

        inButton.addEventListener("click", readFile);

        function readFile() 
        {
            const saveFile = document.getElementById("saveInput").files[0];
            const saveReader = new FileReader();

            if (saveFile.name.startsWith("filech1_") == true)
            {
                document.getElementById("saveConfirmer").innerText = "Valid save file!";
                saveReader.readAsText(saveFile);
                document.getElementById("testP").innerText = saveReader.result;
            }
            else if (saveFile.name.startsWith("filech2_") == true || saveFile.name.startsWith("filech3_") == true || saveFile.name.startsWith("filech4_") == true)
            {
                document.getElementById("saveConfirmer").innerText = "No late chapter support.";
            }
            else
            {
                document.getElementById("saveConfirmer").innerText = "Not a deltarune savefile";
            }
            
        }
        
    </script>
</body>
</html>

